---
title: Database System Concepts - notes
author: lambdaxing
date: 2022-12-06 18:00:00 +0800
categories: [Notes, Database]
tags: [Database]
---


&emsp;&emsp;《Database System Concepts: Sixth Edition》笔记。

# 一. 引言：数据库系统的基本原理
&emsp;&emsp;数据库管理系统（Database-Management System，DBMS）由一个互相关联的数据的集合和一组用于访问这些数据的程序组成。计算机科学家开发了大量的用于有效管理数据的**概念**和**技术**，本书所关注的正是这些概念和技术。

## 1. 数据库系统的目标

&emsp;&emsp;数据库系统为了解决文件处理系统（在操作系统的文件处理系统中存储组织信息）中存在的问题，比如数据冗余、数据不一致、数据访问困难、数据孤立、完整性问题、原子性问题、并发与安全等，提出了许多**概念**和**算法**。

## 2. 数据视图

&emsp;&emsp;数据库系统是一些互相关联的数据以及一组使得用户可以访问和修改这些数据的程序的集合。数据库系统的一个主要目的是给用户提供数据的抽象视图，即数据库系统隐藏关于数据存储和维护的某些细节。

### 数据抽象

&emsp;&emsp;**数据抽象**的三个层次：
+ 物理层：描述数据的实际存储，物理层详细描述复杂的底层数据结构。
+ 逻辑层：描述数据库中存储什么数据以及这些数据间存在什么关系。
+ 视图层：最高层次的抽象，描述整个数据库的某个部分。多数用户不需要关心所有的信息，而只需要访问数据库的一部分，系统可以为同一数据库提供多个视图，同时屏蔽逻辑层细节和提供一些安全性机制。

### 实例和模式

&emsp;&emsp;**实例**：特定时刻存储在数据库中的信息的集合称作数据库的一个实例（instance）。

&emsp;&emsp;**模式**：数据库的总体设计称作数据库模式（schema）。

&emsp;&emsp;根据不同的数据抽象层次，数据库系统的三种不同模式：
+ 物理模式：在物理层描述数据库的设计。
+ 逻辑模式：在逻辑层描述数据库的设计。
+ 视图模式：也叫子模式，描述了数据库的不同视图。

### 数据模型

&emsp;&emsp;**数据模型**：数据库结构的基础是数据模型（data model）。数据模型是一个描述数据、数据联系、数据语义以及一致性约束的概念工具的集合。**数据模型提供了一种描述物理层、逻辑层以及视图层数据库设计的方式**。

&emsp;&emsp;四类数据模型：
+ 关系模型（relational model）。
+ 实体-联系模型（entity-relationship model，ER），用于数据库设计。
+ 面向对象的数据模型（object-based data model）。
+ 对象-关系数据模型（object-relational data model)，一个将对象数据模型和关系数据模型的特点结合在一起的数据模型。
+ 半结构化数据模型（semistructured data model），允许那些相同类型的数据项有不同的属性集的数据说明。

&emsp;&emsp;网状数据模型（network data model）和层次数据模型（hierarchical data model）先于关系模型出现，它们和底层的实现联系紧密，使数据建模变得复杂。

## 3. 数据库语言

&emsp;&emsp;数据库系统提供 **数据定义语言（data-definition language）** 来定义数据库模式，以及 **数据库操纵语言（data-manipulation language，DML）** 来表达数据库的查询与更新。

### DML：用户访问或操纵数据，即增删改查
&emsp;&emsp;两类基本的数据操纵语言：
+ 过程化DML（procedural DML)，要求用户指定需要什么数据以及如何获得这些数据。
+ 声明式DML（declarative DML），非过程化DML。

&emsp;&emsp;三个抽象层次不仅可以用于定义或构造数据，还可以用于操纵数据。在物理层，必须定义可高效访问数据的算法；在更高的抽象层次，则强调易用性。例如，数据库系统的查询处理器将DML的查询语句翻译成数据库系统物理层的动作序列。

### DDL：定义数据库模式和数据的其他特征，包括：
+ 数据库系统使用的存储结构和访问方式，即数据库模式的实现细节。
+ 完整性约束：
     - 域约束（domain constraint）。每个属性都必须对应于一个所有可能的取值构成的域（例如，整型、字符型、日期/时间型），约束它可以取的值。
     - 参照完整性（referential integrity）：一个关系中给定属性集上的取值也在另一关系的某一属性集的取值中出现。
     - 断言（assertion）。一个断言就是数据库需要时刻满足的某一条件，域约束和参照完整性是断言的特殊形式。
     - 授权（authorization）。对用户加以区别，以授权来表达：读权限、插入权限、更新权限、删除权限。

&emsp;&emsp;DDL 以一些指令（语句）作为输入，生成一些输出。DDL 的输出放在**数据字典（data dictionary）**中，数据字典包含了**元数据（metadata）**，元数据是关于数据的数据。可把数据字典看作一种特殊的表，只能由数据库系统本身来访问和修改，在读取和修改实际的数据前，数据库系统先要参考数据字典。

## 4. 关系数据库

&emsp;&emsp;关系数据库基于关系模型，使用一系列表来表达数据以及这些数据之间的联系。关系模型是基于记录的模型，数据库的结构是几种固定格式的记录。每个表包含一种特定类型的记录，每种记录类型定义固定数目的字段或属性，表的列对应记录类型的属性。

## 5. 数据库设计

&emsp;&emsp;数据库设计的主要内容是数据库模式的设计。

### 设计过程

+ 高层的数据模型说明数据库用户的数据需求，以及怎样构造数据库结构满足这些需求。因此，数据库设计的初始阶段是全面刻画预期的数据库用户的数据需求，制定出用户需求的规格文档。
+ 选定数据模型，将需求转换成一个数据库的概念模式，它描述数据以及数据之间的联系，而不是指定物理的存储细节。关系模型中，概念设计包括数据库中的属性，以及如何将这些属性组织到多个表中，有商业上的决策（前者），也有计算机科学的问题（后者）。后者的两种解决方法：实体-联系模型以及规范化算法。
+ 在功能需求说明中，用户描述数据之上的各种操作（或事务），例如增删改查等。
+ 将抽象数据模型转换到数据库实现。
    - 逻辑设计阶段：设计者将高层的概念模式映射到要使用的数据库系统的实现数据模型上。
    - 物理设计阶段：指定数据库的物理特性，包括文件组织的形式以及内部的存储结构。

### 实体-联系模型

&emsp;&emsp;E-R 模型使用一组称为实体的基本对象，以及这些对象间的联系。数据库中实体通过属性集合来描述，联系是几个实体之间的关联。数据库的总体逻辑结构（模式）可以用实体-联系图（E-R 图）进行图形化表示。

### 规范化

&emsp;&emsp;规范化的目标是生成一个关系模式集合，使存储信息时没有不必要的冗余，同时又能很轻易地检索数据。这种方法是设计一种符合适当的范式（normal form）的模式。

## 6. 数据存储和查询

&emsp;&emsp;数据库系统划分为不同的模块，每个模块完成整个系统的一个功能。数据库系统的功能部件大致可分为存储管理器和查询处理器。

### 存储管理器

&emsp;&emsp;存储管理器负责在数据库中存储底层数据，也是应用程序以及向系统提交的查询之间提供接口的部件。存储管理器负责与文件管理器进行交互，原始数据通过操作系统提供的文件系统存储在磁盘上。存储管理器将各种DML语句翻译为底层文件系统命令。因此，存储管理器负责数据库中数据的存储、检索和更新。

&emsp;&emsp;存储管理部件包括：
+ 权限及完整性管理器，检查完整性约束和用户权限。
+ 事务管理器（transaction manager）。
+ 文件管理器（file manager），管理磁盘空间的分配，管理用于表示磁盘上所存储信息的数据结构。
+ 缓冲区管理器（buffer manager），管理内存中的磁盘缓存。
+ 数据文件（data file），存储数据库自身。
+ 数据字典（data dictionary），存储关于数据库结构的元数据，尤其是数据库模式。
+ 索引（index），提供对数据项的快速访问。

### 查询处理器
+ DDL解释器（DDL interpreter），解释DDL语句并将这些定义记录在数据字典中。
+ DML编译器（DML compiler），将DML语句翻译成一个执行方案，包括一系列查询执行引擎能理解的低级指令。DML编译器还进行查询优化。
+ 查询执行引擎（query evaluation engine），执行由DML编译器产生的低级指令。

## 7. 事务管理
+ 原子性（atomicity）：一种要么完成要么不发生的要求。
+ 一致性（consistency）：满足数据库完整性约束的正确性要求。
+ 持久性（durability）：数据能保持新值的要求。

&emsp;&emsp;事务（transaction）是数据库应用中完成单一逻辑功能的操作集合。每一个事务是一个既具有原子性又具一致性的单元。事务的定义应使之能保持数据库的一致性，这是程序员的职责。原子性和持久性的保证是 **恢复管理器（recovery manager）** 的职责，失败的事务使得数据库系统必须进行故障恢复，即检测系统故障并将数据库恢复到故障发生以前的状态。

&emsp;&emsp;**并发控制器（concurrency control manager）** 控制并发事务间的相互影响，保证数据库一致性。

&emsp;&emsp;**事务管理器（transaction manager）** 包括并发控制管理器和恢复管理器。

## 8. 数据库体系结构

### 一个数据库系统各个部分以及它们之间联系的图：

#